% Latex header for doxygen 1.9.4
  % Handle batch mode
%%BEGIN LATEX_BATCHMODE
  \batchmode
%%END LATEX_BATCHMODE

  % to overcome problems with too many open files
  \let\mypdfximage\pdfximage\def\pdfximage{\immediate\mypdfximage}

  % Set document class depending on configuration
%%BEGIN COMPACT_LATEX
  \documentclass[]{article}
%%END COMPACT_LATEX
%%BEGIN !COMPACT_LATEX
  \documentclass[oneside]{book}
%%END !COMPACT_LATEX

\RequirePackage[utf8]{inputenc}
\RequirePackage[T2A]{fontenc}

  %% moved from doxygen.sty due to workaround for LaTex 2019 version and unmaintained tabu package
  \usepackage{ifthen}
  \ifx\requestedLaTeXdate\undefined
    \usepackage{array}
  \else
    \usepackage{array}[=2016-10-06]
  \fi
  %%

  % Packages required by doxygen
  \usepackage{fixltx2e} % for \textsubscript
  \usepackage{doxygen}

  $extralatexstylesheet

  \usepackage{graphicx}
  \usepackage[utf8]{inputenc}
  \usepackage{makeidx}
  \PassOptionsToPackage{warn}{textcomp}
  \usepackage{textcomp}
  \usepackage[nointegrals]{wasysym}
  \usepackage{ifxetex}

  % NLS support packages
  $languagesupport

  % Define default fonts
  % Font selection
%%BEGIN LATEX_FONTENC
  \usepackage[$latexfontenc]{fontenc}
%%END LATEX_FONTENC

  % set main and monospaced font
  $latexfont

  \usepackage{sectsty}
  \allsectionsfont{%
    \fontseries{bc}\selectfont%
    \color{darkgray}%
  }
  \renewcommand{\DoxyLabelFont}{%
    \fontseries{bc}\selectfont%
    \color{darkgray}%
  }
  \newcommand{\+}{\discretionary{\mbox{\scriptsize$\hookleftarrow$}}{}{}}

   % Arguments of doxygenemoji:
   % 1) ':<text>:' form of the emoji, already LaTeX-escaped
   % 2) file with the name of the emoji without the .png extension
   % in case image exist use this otherwise use the ':<text>:' form
   \newcommand{\doxygenemoji}[2]{%
     \IfFileExists{$latexemojidirectory/#2.png}{\raisebox{-0.1em}{\includegraphics[height=0.9em]{$latexemojidirectory/#2.png}}}{#1}%
   }

  % Page & text layout
  \usepackage{geometry}
  \geometry{%
    $papertype,%
    top=2.5cm,%
%    bottom=2.5cm,%
%    left=2.5cm,%
%    right=2.5cm%
    bottom=2.5cm,%
	left=2.5cm,%
	right=1.0cm%
  }

  % Allow a bit of overflow to go unnoticed by other means
  \tolerance=750
  \hfuzz=15pt
  \hbadness=750
  \setlength{\emergencystretch}{15pt}
  \setlength{\parindent}{0cm}
  \newcommand{\doxynormalparskip}{\setlength{\parskip}{3ex plus 2ex minus 2ex}}
  \newcommand{\doxytocparskip}{\setlength{\parskip}{1ex plus 0ex minus 0ex}}
  \doxynormalparskip
  % Redefine paragraph/subparagraph environments, using sectsty fonts
  \makeatletter
  \renewcommand{\paragraph}{%
    \@startsection{paragraph}{4}{0ex}{-1.0ex}{1.0ex}{%
      \normalfont\normalsize\bfseries\SS@parafont%
    }%
  }
  \renewcommand{\subparagraph}{%
    \@startsection{subparagraph}{5}{0ex}{-1.0ex}{1.0ex}{%
      \normalfont\normalsize\bfseries\SS@subparafont%
    }%
  }
  \makeatother

  \makeatletter
  \newcommand\hrulefilll{\leavevmode\leaders\hrule\hskip 0pt plus 1filll\kern\z@}
  \makeatother

  % Headers & footers
  \usepackage{fancyhdr}
  \pagestyle{fancyplain}
  \renewcommand{\footrulewidth}{0.0pt}
  \renewcommand{\headrulewidth}{0.0pt}

  \fancypagestyle{fancyplain}{
    \fancyhf{}
    \fancyhead[CE, CO]{\bfseries\thepage}
%    \fancyhead[LE, RO]{\bfseries\thepage}
%    \fancyhead[LO]{\bfseries\rightmark}
%    \fancyhead[RE]{\bfseries\leftmark}
%    \fancyfoot[LO, RE]{\bfseries\scriptsize $generatedby Doxygen }
  }

  \fancypagestyle{plain}{
    \fancyhf{}
%    \fancyfoot[LO, RE]{\bfseries\scriptsize $generatedby Doxygen }
%    \renewcommand{\headrulewidth}{0.0pt}
  }

  \pagestyle{fancyplain}


%%BEGIN !COMPACT_LATEX
  \renewcommand{\chaptermark}[1]{%
    \markboth{#1}{}%
  }
%%END !COMPACT_LATEX
  \renewcommand{\sectionmark}[1]{%
    \markright{\thesection\ #1}%
  }

  % ToC, LoF, LoT, bibliography, and index
  % Indices & bibliography
  \usepackage{natbib}
  \usepackage[titles]{tocloft}
  \setcounter{tocdepth}{3}
  \setcounter{secnumdepth}{5}

  % creating indexes
  $makeindex

  $extralatexpackages

  $latexspecialformulachars

%%BEGIN FORMULA_MACROFILE
  \input{$formulamacrofile}
%%END FORMULA_MACROFILE

  % Hyperlinks
%%BEGIN PDF_HYPERLINKS
    % Hyperlinks (required, but should be loaded last)
    \ifpdf
      \usepackage[pdftex,pagebackref=true]{hyperref}
    \else
      \ifxetex
        \usepackage[pagebackref=true]{hyperref}
      \else
        \usepackage[ps2pdf,pagebackref=true]{hyperref}
      \fi
    \fi

    \hypersetup{%
      colorlinks=true,%
      linkcolor=blue,%
      citecolor=blue,%
      unicode,%
      pdftitle={$projectname},%
      pdfsubject={$projectbrief}%
    }

%%END PDF_HYPERLINKS

  % Custom commands used by the header
  % Custom commands
  \newcommand{\clearemptydoublepage}{%
    \newpage{\pagestyle{empty}\cleardoublepage}%
  }

  % caption style definition
  \usepackage{caption}
  \captionsetup{labelsep=space,justification=centering,font={bf},singlelinecheck=off,skip=4pt,position=top}


  % in page table of contents
  \usepackage{etoc}
  \etocsettocstyle{\doxytocparskip}{\doxynormalparskip}

  % prevent numbers overlap the titles in toc
  \renewcommand{\numberline}[1]{#1~}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\linespread{1.25}	% Это эквивалент 1,5 интервала в ворде

\clubpenalty=10000  % Это костыль против
\widowpenalty=10000 % "висячих" строк
\righthyphenmin=200 % Избавляемся
\sloppy	            % от переносов слов
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Создает переменную, задается \cmd{val}, возвращается \@cmd
% \var{cmd}
\def\var#1{
	\expandafter
	\def\csname #1\endcsname##1{
		\ifx&##1&
		\ClassError
		{espd}
		{The \@backslashchar#1 cannot be empty}
		{You should specify non-empty #1 by typing \@backslashchar#1{#1 name}}
		\fi
		\expandafter\def\csname @#1\endcsname{##1}}
	\expandafter
	\def\csname @#1\endcsname{
		\ClassError
		{espd}
		{No \@backslashchar#1 given}
		{You should specify #1 by typing \@backslashchar#1{#1 name} in the preamble}}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Создает переменную, задается \cmd{val}, возвращается \@cmd (по умолчанию - пустая строка)
% \var{cmd}
\def\varempty#1{
	\expandafter
	\def\csname #1\endcsname##1{\expandafter\def\csname @#1\endcsname{##1}}
	\expandafter
	\def\csname @#1\endcsname{}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Пишет в AUX файл данную пару ключ-значение
% \set{key}{val}
\def\set#1#2{\write\@auxout{\string\newlabel{#1}{#2}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Получает из AUX файла значение по ключу
% \get{key}
\def\get#1{\csname r@#1\endcsname}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Получает из AUX файла значение по ключу (по умолчанию 0)
% \get{key}
\def\getnum#1{\ifcsname r@#1\endcsname \csname r@#1\endcsname \else 0 \fi}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ПЕРЕМЕННЫЕ И КОНСТАНТЫ

% Размеры шрифта
%\renewcommand{\normalsize}{\fontsize{12pt}{18pt}\selectfont}
%\newcommand{\titlesize}{\fontsize{14pt}{21pt}\selectfont}
%\newcommand{\approvalsize}{\fontsize{17pt}{24pt}\selectfont}
%\newcommand{\sectionsize}{\fontsize{17pt}{18pt}\selectfont}
%\newcommand{\subsectionsize}{\fontsize{14pt}{16pt}\selectfont}
%\newcommand{\attachmentsize}{\fontsize{17pt}{24pt}\selectfont}
%\newcommand{\tabletextsize}{\fontsize{10pt}{15pt}\selectfont}
%\newcommand{\footnotesize}{\fontsize{8pt}{12pt}\selectfont}
%\newcommand{\footnotetextsize}{\fontsize{10pt}{15pt}\selectfont}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FIXED MY VERSION
\renewcommand{\normalsize}{\fontsize{14pt}{18pt}\selectfont}
\newcommand{\titlesize}{\fontsize{14pt}{21pt}\selectfont}
\newcommand{\approvalsize}{\fontsize{17pt}{24pt}\selectfont}
\newcommand{\sectionsize}{\fontsize{14pt}{18pt}\selectfont}
\newcommand{\subsectionsize}{\fontsize{14pt}{16pt}\selectfont}
\newcommand{\attachmentsize}{\fontsize{14pt}{18pt}\selectfont}
%\newcommand{\tabletextsize}{\fontsize{10pt}{15pt}\selectfont}
\newcommand{\tabletextsize}{\fontsize{12pt}{15pt}\selectfont}
%\newcommand{\picturetextsize}{\fontsize{12pt}{15pt}\selectfont} % smaller font
\newcommand{\picturetextsize}{\fontsize{14pt}{18pt}\selectfont} % normal
\newcommand{\listingtextsize}{\fontsize{10pt}{10pt}\selectfont}
\renewcommand{\footnotesize}{\fontsize{8pt}{12pt}\selectfont}
\newcommand{\footnotetextsize}{\fontsize{10pt}{15pt}\selectfont}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Бумага
\setlength{\paperwidth}{210mm}
\setlength{\paperheight}{297mm}
\setlength{\pdfpagewidth}{\paperwidth}
\setlength{\pdfpageheight}{\paperheight}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Отступы и размеры
\setlength{\hoffset}{-25.4mm}
\setlength{\voffset}{-25.4mm}
%\setlength{\oddsidemargin}{20mm}
%\setlength{\textwidth}{180mm}
\setlength{\oddsidemargin}{25mm} % Лучше поле задать 25 мм, т.к. подшивают обычно 20 мм
\setlength{\textwidth}{175mm}
\setlength{\topmargin}{7.5mm}
\setlength{\textheight}{257mm} % 297-25-257=15 - нижнее поле
\setlength{\parindent}{10mm} % Абзацный отступ
\setlength{\parskip}{2mm}
%\setlength{\parskip}{0mm}
\setlength{\headheight}{10mm}
\setlength{\headsep}{7.5mm}
\setlength{\arrayrulewidth}{0.1pt}
\newlength{\tabmarg}
\setlength{\tabmarg}{2mm}
\setlength{\tabcolsep}{\tabmarg}
\raggedbottom
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Константы
\def\wordagree{Согласовано}
\def\wordapprove{Утверждаю}
\def\wordopenquote{<<}
\def\wordclosequote{>>}
\def\wordyear{г.}
\def\wordapproval{Лист утверждения}
\def\wordapprovalpostfix{-ЛУ}
\def\wordperformer{Исполнитель}
\def\wordperformers{Исполнители}
\def\wordapproved{Утвержден}
\def\wordsheets{Листов}
\def\wordannotation{Аннотация}
\def\wordterms{Перечень терминов}
\def\wordabbreviations{Перечень сокращений}
\def\wordcontents{Содержание}
\def\wordattachment{Приложение}
\def\wordoriginvnumber{Инв. \textnumero~подл.}
\def\wordsignanddate{\wordsign и дата}
\def\wordreferencenumber{Справ.~\textnumero}
\def\wordfirstapplication{Перв.~примен.}
\def\wordinstinvnumber{Взам. инв. \textnumero}
\def\wordduplinvnumber{Инв. \textnumero~дубл.}
\def\wordregistration{Лист регистрации изменений}
\def\wordsheetnumber{Номера листов (страниц)}
\def\wordsheetsindoc{Всего листов (страниц) в докум.}
\def\worddocnumber{\textnumero\\документа}
\def\wordincldocanddate{Входящий \textnumero~сопрово-дительного докум. и дата}
\def\wordsign{Подп.}
\def\worddate{Дата}
\def\wordchanges{Изм.}
\def\wordchanged{изменен-\\ных}
\def\wordreplaced{заменен-\\ных}
%\def\wordchanged{измененных}
%\def\wordreplaced{замененных}
\def\wordnew{новых}
\def\wordannulled{аннули-рованных}
\def\wordimage{Рис.}
\def\wordrefimage{рис.~}
\def\wordbibliography{Перечень использованных источников}
\def\wordempty{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Переменные
\var{customername} % Заказчик
\var{customerrank}

\var{fromcustomername} % От заказчика
\var{fromcustomerrank}

\varempty{chiefconstructorname} % Главный конструктор
\varempty{chiefconstructorrank}

\varempty{headofdepartmentrank} % Начальник подразделения (Научно-тематического центра)
\varempty{headofdepartmentname}

\varempty{deputyofchiefconstructorrank} % Заместитель главного конструктора
\varempty{deputyofchiefconstructorname} 

\varempty{headoflaboratoryrank} % Начальник лаборатории
\varempty{headoflaboratoryname}

\varempty{developerrank} % Разработчик 
\varempty{developername}

\varempty{normocontrollerrank} % Нормоконтроллер
\varempty{normocontrollername}

\var{year}
\var{title}
\var{type}
\var{typecode}
\var{organizationcode}
\var{redaction}
\var{documentnumber}
\var{partnumber}
\var{registrationcode}

\varempty{authorname} % Исполнитель, если он один
\varempty{authorrank}

\varempty{authori} % Исполнители, если их много
\varempty{authorii}
\varempty{authoriii}
\varempty{authoriv}
\varempty{authorv}
\varempty{authorranki}
\varempty{authorrankii}
\varempty{authorrankiii}
\varempty{authorrankiv}
\varempty{authorrankv}

\varempty{firstapplication}
\varempty{referencenumber}
\varempty{emptyvar}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareOption{exampletask}{
	\type{Пример оформления документации}
	\typecode{ПРИМЕР}
}
\DeclareOption{technicaltask}{
	\type{Техническое задание}
	\typecode{ТЗ}
}
\DeclareOption{codelisting}{
	\type{Текст программы}
	\typecode{12}
}
\DeclareOption{programdescription}{
	\type{Описание программы}
	\typecode{13}
}
\DeclareOption{listoperationaldocuments}{
	\type{Ведомость эксплуатационных документов}
	\typecode{20}
}
\DeclareOption{formular}{
	\type{Формуляр}
	\typecode{30}
}
\DeclareOption{applicationdescription}{
	\type{Описание применения}
	\typecode{31}
}
\DeclareOption{systemprogrammermanual}{
	\type{Руководство системного программиста}
	\typecode{32}
}
\DeclareOption{programmermanual}{
	\type{Руководство программиста}
	\typecode{33}
}
\DeclareOption{operatormanual}{
	\type{Руководство оператора}
	\typecode{34}
}
\DeclareOption{languagedescription}{
	\type{Описание языка}
	\typecode{35}
}
\DeclareOption{guideoftechnicalservice}{
	\type{Руководство по техническому обслуживанию}
	\typecode{46}
}
\DeclareOption{testingmethods}{
	\type{Программа и методика испытаний}
	\typecode{51}
}
\DeclareOption{explanationnote}{
	\type{Пояснительная записка}
	\typecode{81}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Код документа
%\def\fullcode{\@organizationcode.\@registrationcode-\@redaction~\@typecode~\@documentnumber-\@partnumber}
\def\fullcode{\@organizationcode.\@registrationcode-\@redaction~\@typecode~\@documentnumber}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Код документа с постфиксом листа утверждения
\def\fullcodeapp{\fullcode\wordapprovalpostfix}

% Инициализация параметров
\ProcessOptions*
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% МАКРОСЫ ДЛЯ ВНУТРЕННЕГО ИСПОЛЬЗОВАНИЯ
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Вставляет место для подписи для исполнителя без проверки на пустоту строк
\def\onlyauthorraw#1{
	\vskip 1mm\rule{3cm}{0.1pt}~#1\\\vskip 1mm\wordopenquote\rule{8mm}{0.1pt}\wordclosequote~\rule{3cm}{0.1pt} \@year~\wordyear\\\vskip 5mm
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% То же, но делает проверку на пустоту строк
% \onlyauthor{author}
\def\onlyauthor#1{
	\if&#1&\else%
	\onlyauthorraw{#1}
	\fi
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Вставляет должность и место для подписи для исполнителя без проверки на пустоту строк
% \titleauthorraw{author}{authorrank}
\def\titleauthorraw#1#2{
	\vskip 1mm #2\\\vskip 1mm\rule{3cm}{0.1pt}~#1\\\vskip 1mm \wordopenquote\rule{8mm}{0.1pt}\wordclosequote~\rule{3cm}{0.1pt} \@year~\wordyear\\\vskip 5mm
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% То же, но делает проверку на пустоту строк
% \titleauthor{author}{authorrank}
\def\titleauthor#1#2{
	\if&#1#2&\else%
	\titleauthorraw{#1}{#2}
	\fi
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Модификация перевода строки для использования \centering и \MakeUppercase
% \protectlinebreak
\def\protectlinebreak{
	\let\defaultlinebreak\\
	\renewcommand{\\}{\protect\defaultlinebreak}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Создает ячейку заданных размеров с центрованным текстом внутри
% \def{width}{height}{text}
\def\cell#1#2#3{
	\parbox[c][#2][c]{#1}{\centering #3}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Создает ячейку с центрованным текстом внутри с настраиваемой реальной высотой
% \def{width}{height}{realheight}{text}
%\def\vcell#1#2#3#4{\parbox[c][#3][b]{#1}{\footnotesize}{\fontsize{8pt}{12pt}\selectfont}
%	\newcommand{\foovbox to #2{\cell{#1}{#2}{#4}\vss}}}

\def\vcell#1#2#3#4{\parbox[c][#3][b]{#1}{\vbox to #2{\cell{#1}{#2}{#4}\vss}}}

\def\writesection#1{
	%  \newpage
	\begin{center}
		\centering\sectionsize\MakeUppercase{#1}
	\end{center}
	\par
}

\def\writesubsection#1{
	\begingroup
	\par
	\parindent -1cm
	\leftskip 2cm
	\interlinepenalty\@M
	\vspace{4mm}
	{\subsectionsize#1}%
	\vspace{2mm}
	\par
	\endgroup
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% СЕКЦИОНИРОВАНИЕ
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Счетчики
%\setcounter{secnumdepth}{4}
%\newcounter{section}
%\newcounter{subsection}[section]
%\newcounter{paragraph}[subsection]
%\newcounter{subparagraph}[paragraph]
\newcounter{attachment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Разделы, подразделы, пункты и подпункты
\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{\arabic{section}.\arabic{subsection}}
\renewcommand{\theparagraph}{\arabic{section}.\arabic{subsection}.\arabic{paragraph}}
\renewcommand{\thesubparagraph}{\arabic{section}.\arabic{subsection}.\arabic{paragraph}.\arabic{subparagraph}}
\renewcommand{\theattachment}{\arabic{attachment}}
\newcommand{\numsection}{\thesection.}
\newcommand{\numsubsection}{\thesubsection.}
\newcommand{\numparagraph}{\theparagraph.}
\newcommand{\numsubparagraph}{\thesubparagraph.}
\renewcommand{\section}[1]{
	\ifx&#1&
	\ClassError
	{espd}
	{Empty section title}
	{According to GOST 19.106-78, section title can not be empty}
	\fi
	\refstepcounter{section}
	\writesection{\numsection~#1}  
	\addcontentsline{toc}{section}{\numsection~#1}
}
\renewcommand{\subsection}[1]{
	\ifx&#1&
	\ClassError
	{espd}
	{Empty subsection title}
	{According to GOST 19.106-78, subsection title can not be empty}
	\fi
	\refstepcounter{subsection}
	\writesubsection{\numsubsection~#1}
	\addcontentsline{toc}{subsection}{\numsubsection~#1}
}
\renewcommand{\paragraph}[1]{  
	\parskip1mm
	\refstepcounter{paragraph}
	\writesubsection{\numparagraph~#1}
	\ifx&#1&\else
	\addcontentsline{toc}{paragraph}{\numparagraph~#1}
	\fi  	
}
\renewcommand{\subparagraph}[1]{
	\refstepcounter{subparagraph}
	\writesubsection{\numsubparagraph~#1}
	\ifx&#1&\else
	\addcontentsline{toc}{subparagraph}{\numsubparagraph~#1}
	\fi
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Штампы в разных вариациях по ГОСТ19
\newcommand{\stampleftfull}{
	\setlength{\arrayrulewidth}{0.5mm}
	\tabletextsize
	\setlength{\tabcolsep}{0mm}
	%	\itshape\fontspec{GOST type A Italic} % Italic приходится задавать так
	\begin{tabular}{|p{24.5mm}|p{34.5mm}|p{24.5mm}|p{24.5mm}|p{34.5mm}|p{21.0mm}|p{59.5mm}|p{59.5mm}|}
		\cline{1-5}\cline{7-8}
		\cell{24.5mm}{5mm}{\wordoriginvnumber} & 
		\cell{34.5mm}{5mm}{\wordsignanddate} & 
		\cell{24.5mm}{5mm}{\wordinstinvnumber} & 
		\cell{24.5mm}{5mm}{\wordduplinvnumber} & 
		\cell{34.5mm}{5mm}{\wordsignanddate} &
		\cell{21.0mm}{5mm}{} & 
		\cell{59.5mm}{5mm}{\wordreferencenumber} &
		\cell{59.5mm}{5mm}{\wordfirstapplication} \\
		\cline{1-5}\cline{7-8}
		\cell{24.5mm}{7mm}{} & & & & & & \cell{59.5mm}{7mm}{\normalsize\@referencenumber} & \cell{59.5mm}{7mm}{\normalsize\@firstapplication} \\
		\cline{1-5}\cline{7-8}
	\end{tabular}
	\setlength{\tabcolsep}{\tabmarg}
}
\newcommand{\stampleftshort}{
	\setlength{\arrayrulewidth}{0.5mm}
	\tabletextsize
	\setlength{\tabcolsep}{0mm}
	%	\itshape\fontspec{GOST type A Italic} % Italic приходится задавать так
	\begin{tabular}{|p{24.5mm}|p{34.5mm}|p{24.5mm}|p{24.5mm}|p{34.5mm}|p{21.5mm} p{60mm} p{60mm}}
		\cline{1-5}
		\cell{24.5mm}{5mm}{\wordoriginvnumber} & 
		\cell{34.5mm}{5mm}{\wordsignanddate} & 
		\cell{24.5mm}{5mm}{\wordinstinvnumber} & 
		\cell{24.5mm}{5mm}{\wordduplinvnumber} & 
		\cell{34.5mm}{5mm}{\wordsignanddate} &
		\cell{21.5mm}{5mm}{} & 
		\cell{60mm}{5mm}{} &
		\cell{60mm}{5mm}{} \\
		\cline{1-5}
		\cell{24.5mm}{7mm}{} & & & & & & & \\
		\cline{1-5}
	\end{tabular}
	\setlength{\tabcolsep}{\tabmarg}
}
\newcommand{\stampleftonlyfirstapp}{
	\setlength{\arrayrulewidth}{0.5mm}
	\tabletextsize
	\setlength{\tabcolsep}{0mm}
	%	\itshape\fontspec{GOST type A Italic} % Italic приходится задавать так
	\begin{tabular}{|p{24.5mm}|p{34.5mm}|p{24.5mm}|p{24.5mm}|p{34.5mm}|p{21.5mm} p{59.5mm}|p{59.5mm}|}
		\cline{1-5}\cline{8-8}
		\cell{24.5mm}{5mm}{\wordoriginvnumber} & 
		\cell{34.5mm}{5mm}{\wordsignanddate} & 
		\cell{24.5mm}{5mm}{\wordinstinvnumber} & 
		\cell{24.5mm}{5mm}{\wordduplinvnumber} & 
		\cell{34.5mm}{5mm}{\wordsignanddate} &
		\cell{21.0mm}{5mm}{} & 
		\cell{59.5mm}{5mm}{} &
		\cell{59.5mm}{5mm}{\wordfirstapplication} \\
		\cline{1-5}\cline{8-8}
		\cell{24.5mm}{7mm}{} & & & & & & & \cell{59.5mm}{7mm}{\normalsize\@firstapplication} \\
		\cline{1-5}\cline{8-8}
	\end{tabular}
	\setlength{\tabcolsep}{\tabmarg}
}
\newcommand{\stampleftonlyrefnum}{
	\setlength{\arrayrulewidth}{0.5mm}
	\tabletextsize
	\setlength{\tabcolsep}{0mm}
	%	\itshape\fontspec{GOST type A Italic} % Italic приходится задавать так
	\begin{tabular}{|p{24.5mm}|p{34.5mm}|p{24.5mm}|p{24.5mm}|p{34.5mm}|p{21.0mm}|p{59.5mm}|p{60.0mm}}
		\cline{1-5}\cline{7-7}
		\cell{24.5mm}{5mm}{\wordoriginvnumber} & 
		\cell{34.5mm}{5mm}{\wordsignanddate} & 
		\cell{24.5mm}{5mm}{\wordinstinvnumber} & 
		\cell{24.5mm}{5mm}{\wordduplinvnumber} & 
		\cell{34.5mm}{5mm}{\wordsignanddate} &
		\cell{21.0mm}{5mm}{} & 
		\cell{59.5mm}{5mm}{\wordreferencenumber} &
		\cell{60.0mm}{5mm}{} \\
		\cline{1-5}\cline{7-7}
		\cell{24.5mm}{7mm}{} & & & & & & \cell{59.5mm}{7mm}{\normalsize\@referencenumber} & \\
		\cline{1-5}\cline{7-7}
	\end{tabular}
	\setlength{\tabcolsep}{\tabmarg}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Лист утверждения
%\newcommand{\makeapproval}{
%	\begin{titlepage}
%		\reversemarginpar
%		%  \setlength{\marginparsep}{11.5mm}
%		\setlength{\marginparsep}{17mm}
%		%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftfull}}}
%
%%		\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftshort}}}
%
%		%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftonlyfirstapp}}}
%		%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftonlyrefnum}}}
%		\vskip -\baselineskip
%		\centering
%		\protectlinebreak  
%		\begin{tabular}{c c}
%			\parbox[t][2cm]{0.5\textwidth}{
%				\centering\MakeUppercase{\wordagree}\vskip 2mm\@customerrank\vskip 1mm\onlyauthor{\@customername}
%			} &
%			
%			\parbox[t][2cm]{0.5\textwidth}{
%				\centering\MakeUppercase{\wordapprove}\vskip 2mm\@chiefconstructorrank\vskip 1mm\onlyauthor{\@chiefconstructorname}
%			}
%		\end{tabular}
%		
%		\vskip 3cm
%		\titlesize{\MakeUppercase{\@title}}
%		\vskip 4mm
%		\normalsize\textbf{\@type}
%		\vskip 4mm
%		\normalsize{\MakeUppercase{\wordapproval}}
%		\vskip 4mm
%		\normalsize{\fullcodeapp}
%		\vskip \fill
%		\begin{tabular}{c c}
%			\parbox[t]{0.45\textwidth}{\raggedright
%				% левая колонка:
%				\if& \@headofdepartmentname &	    
%				&
%				\else
%				\titleauthor{\@fromcustomername}{\@fromcustomerrank}} &                       	
%			\fi
%			
%			\parbox[t]{0.4\textwidth}{\raggedright    
%				% правая колонка:
%				
%				\if& \@headofdepartmentname &	    
%				\else
%				\titleauthor{\@headofdepartmentname}{\@headofdepartmentrank}    	
%				\fi
%				
%				\if& \@deputyofchiefconstructorname &	    
%				\else
%				\titleauthor{\@deputyofchiefconstructorname}{\@deputyofchiefconstructorrank} 
%				\fi
%				
%				\if& \@headoflaboratoryname &	
%				\else
%				\titleauthor{\@headoflaboratoryname}{\@headoflaboratoryrank} 
%				\fi
%				
%				\if& \@developername &	
%				\else
%				\titleauthor{\@developername}{\@developerrank} 	
%				\fi
%				
%				\if&\@authorname&
%				\else
%				\if&\@authori\@authorii\@authoriii\@authoriv\@authorv\@authorranki\@authorrankii\@authorrankiii\@authorrankiv\@authorrankv&
%				\wordperformer\\\onlyauthor{\@authorname}
%				\else
%				\wordperformers\\\onlyauthor{\@authori}\onlyauthor{\@authorii}\onlyauthor{\@authoriii}\onlyauthor{\@authoriv}\onlyauthor{\@authorv}
%				\fi
%				\fi
%				
%				\if& \@normocontrollername &	
%				\else
%				\titleauthor{\@normocontrollername}{\@normocontrollerrank}
%				\fi
%				
%			}
%		\end{tabular}
%		\vskip \fill
%		\@year
%		\vskip 5mm
%	\end{titlepage}
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Титульный лист
%\renewcommand{\maketitle}{
%	\begin{titlepage}
%		\reversemarginpar
%		\setlength{\marginparsep}{17mm}
%		%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftfull}}}
%		%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftshort}}}
%		
%%		\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftonlyfirstapp}}}
%		
%		%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftonlyrefnum}}}
%		\vskip -\baselineskip
%		\parbox[t]{0.4\textwidth}{\centering\MakeUppercase{\wordapproved}\\\fullcodeapp}
%		\vskip 8cm
%		\centering
%		\protectlinebreak
%		\titlesize{\MakeUppercase{\@title}}
%		\vskip 4mm
%		\normalsize\textbf{\@type}  
%		\vskip 4mm
%		{\fullcode}
%		\vskip 4mm
%		{\wordsheets~\getnum{lastpage}}
%		\vskip \fill
%		\@year
%		\vskip 5mm
%	\end{titlepage}
%	\stepcounter{page}
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Содержание
%\renewcommand\@pnumwidth{1em}
%\renewcommand\@tocrmarg{4em}
%\renewcommand\@dotsep{4}
%\setcounter{tocdepth}{4}
%\renewcommand\tableofcontents{
%	\newpage
%	\writesection{\wordcontents}
%	\@starttoc{toc}
%}
%%\newcommand\l@section[1]{\@dottedtocline{1}{0cm}{0.5cm}{\textbf{#1}}}
%%\newcommand\l@subsection{\@dottedtocline{2}{0.5cm}{1cm}}
%%\newcommand\l@paragraph{\@dottedtocline{3}{1cm}{1.5cm}}
%%\newcommand\l@subparagraph{\@dottedtocline{4}{1.5cm}{2cm}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\renewcommand\l@section[1]{\@dottedtocline{1}{0cm}{1cm}{#1}}
%\renewcommand\l@subsection{\@dottedtocline{2}{1cm}{2cm}}
%\renewcommand\l@paragraph{\@dottedtocline{3}{2cm}{3cm}}
%\renewcommand\l@subparagraph{\@dottedtocline{4}{3cm}{4cm}}
%\newcommand\l@attachment{\@dottedtocline{1}{0cm}{3cm}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% End of preamble, now comes the document contents
%===== C O N T E N T S =====

%\AtBeginDocument{\makeapproval\maketitle}

\begin{document}
  \raggedbottom

  $latexdocumentpre

  % Titlepage & ToC
%%BEGIN PDF_HYPERLINKS
%%BEGIN USE_PDFLATEX
    % To avoid duplicate page anchors due to reuse of same numbers for
    % the index (be it as roman numbers)
    \hypersetup{pageanchor=false,
                bookmarksnumbered=true,
                pdfencoding=unicode
               }
%%END USE_PDFLATEX
%%END PDF_HYPERLINKS
%  \pagenumbering{alph}

%  \begin{titlepage}
%  \vspace*{7cm}
%  \begin{center}%
%  {\Large $title}\\
%  \vspace*{1cm}
%  {\large $generatedby Doxygen $doxygenversion}\\
%%%BEGIN LATEX_TIMESTAMP
%    \vspace*{0.5cm}
%    {\small $datetime}
%%%END LATEX_TIMESTAMP
%  \end{center}
%  \end{titlepage}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Задание полей титульных страниц
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\productcipher}{АБВГД.12345} % Шифр изделия

\firstapplication{\productcipher} % Первое применение
\referencenumber{\productcipher} % Справ №

\organizationcode{01234} % Код организации
\registrationcode{56789} % Регистрационный код
\redaction{01} % Номер редакции
\documentnumber{03} % Номер документа данного вида
%\partnumber{1} % Номер части документа - чтобы задать - надо фиксить класс espd

% СОГЛАСОВАНО
\customerrank{Начальник\\межгалактической комиссии}
\customername{А.Б.~Заказчиков}

% УТВЕРЖДАЮ
\chiefconstructorrank{Главный конструктор\\изделия \productcipher}
\chiefconstructorname{А.Б.~Главный}

\fromcustomerrank{От межгалактической комиссии}
\fromcustomername{А.Б.~Галактионов}

\headofdepartmentrank{Начальник Центра}
\headofdepartmentname{А.Б.~Чатланин}

\deputyofchiefconstructorrank{Зам.~гл.~конструктора}
\deputyofchiefconstructorname{А.Б.~Заместителев}
%
\developerrank{Разработчик}
\developername{А.Б.~Разработчиков}

%\headoflaboratoryrank{Начальник лаборатории 777}
%\headoflaboratoryname{А.Б.~Лабораториев}

% Исполнитель(и)
\authorname{А.Б.~Пацак}
%%
%\authori{А.Б.~Пацак1}
%\authorii{А.Б.~Пацак2}

\normocontrollerrank{Нормоконтроллер}
\normocontrollername{~}

\title{Изделие \productcipher\\Программный комплекс\\Галактический транклюкатор} 
\year{2022}

	\begin{titlepage}
	\reversemarginpar
	%  \setlength{\marginparsep}{11.5mm}
	\setlength{\marginparsep}{17mm}
	%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftfull}}}
	
	%		\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftshort}}}
	
	%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftonlyfirstapp}}}
	%\marginpar{\vskip -2.5cm \hbox{\rotatebox{90}{\stampleftonlyrefnum}}}
	\vskip -\baselineskip
	\centering
	\protectlinebreak  
	\begin{tabular}{c c}
		\parbox[t][2cm]{0.5\textwidth}{
			\centering\MakeUppercase{\wordagree}\vskip 2mm\@customerrank\vskip 1mm\onlyauthor{\@customername}
		} &
		
		\parbox[t][2cm]{0.5\textwidth}{
			\centering\MakeUppercase{\wordapprove}\vskip 2mm\@chiefconstructorrank\vskip 1mm\onlyauthor{\@chiefconstructorname}
		}
	\end{tabular}
	
	\vskip 3cm
	\titlesize{\MakeUppercase{\@title}}
	\vskip 4mm
	\normalsize\textbf{\@type}
	\vskip 4mm
	\normalsize{\MakeUppercase{\wordapproval}}
	\vskip 4mm
	\normalsize{\fullcodeapp}
	\vskip \fill
	\begin{tabular}{c c}
		\parbox[t]{0.45\textwidth}{\raggedright
			% левая колонка:
			\if& \@headofdepartmentname &	    
			&
			\else
			\titleauthor{\@fromcustomername}{\@fromcustomerrank}} &                       	
		\fi
		
		\parbox[t]{0.4\textwidth}{\raggedright    
			% правая колонка:
			
			\if& \@headofdepartmentname &	    
			\else
			\titleauthor{\@headofdepartmentname}{\@headofdepartmentrank}    	
			\fi
			
			\if& \@deputyofchiefconstructorname &	    
			\else
			\titleauthor{\@deputyofchiefconstructorname}{\@deputyofchiefconstructorrank} 
			\fi
			
			\if& \@headoflaboratoryname &	
			\else
			\titleauthor{\@headoflaboratoryname}{\@headoflaboratoryrank} 
			\fi
			
			\if& \@developername &	
			\else
			\titleauthor{\@developername}{\@developerrank} 	
			\fi
			
			\if&\@authorname&
			\else
			\if&\@authori\@authorii\@authoriii\@authoriv\@authorv\@authorranki\@authorrankii\@authorrankiii\@authorrankiv\@authorrankv&
			\wordperformer\\\onlyauthor{\@authorname}
			\else
			\wordperformers\\\onlyauthor{\@authori}\onlyauthor{\@authorii}\onlyauthor{\@authoriii}\onlyauthor{\@authoriv}\onlyauthor{\@authorv}
			\fi
			\fi
			
			\if& \@normocontrollername &	
			\else
			\titleauthor{\@normocontrollername}{\@normocontrollerrank}
			\fi
			
		}
	\end{tabular}
	\vskip \fill
	\@year
	\vskip 5mm
	\end{titlepage}


% \makeapproval
% \maketitle

%%BEGIN !COMPACT_LATEX
  \clearemptydoublepage
%%END !COMPACT_LATEX
%  \pagenumbering{roman}

  \tableofcontents
%%BEGIN !COMPACT_LATEX
  \clearemptydoublepage
%%END !COMPACT_LATEX
  \pagenumbering{arabic}

%%BEGIN PDF_HYPERLINKS
%%BEGIN USE_PDFLATEX
  % re-enable anchors again
  \hypersetup{pageanchor=true}
%%END USE_PDFLATEX
%%END PDF_HYPERLINKS

%--- Begin generated contents ---
